{"ast":null,"code":"import _regeneratorRuntime from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{CardText,CardTitle,CardSubtitle,TabContent,TabPane,Nav,NavItem,Row,Col,Media}from\"reactstrap\";import classnames from'classnames';import rp from\"request-promise\";import cheerio from\"cheerio\";import{FiPlusSquare,FiMinusSquare}from\"react-icons/fi\";import{NavLink}from\"react-router-dom\";import{auth,db}from\"./Firebase\";var ComingSoon=/*#__PURE__*/function(_Component){_inherits(ComingSoon,_Component);function ComingSoon(){var _this;_classCallCheck(this,ComingSoon);_this=_possibleConstructorReturn(this,_getPrototypeOf(ComingSoon).call(this));_this.state={value:0,dates:[],activeTab:\"\",apis:[],isSignedIn:false,removeButton:[]};_this.handleWatchlist=_this.handleWatchlist.bind(_assertThisInitialized(_this));_this.setWatchList=_this.setWatchList.bind(_assertThisInitialized(_this));return _this;}_createClass(ComingSoon,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return rp(\"https://cors-anywhere.herokuapp.com/https://www.imdb.com/calendar?region=US&ref_=rlm\").then(function(html){var dates=[],apis=[];var $=cheerio.load(html);$(\"#main h4\").each(function(){var date=$(this).prepend().text();dates.push(date);});_this2.setState({dates:dates});$(\"#main ul li a\").each(function(){var name=$(this).attr(\"href\");var link=name.match(/(?<=title\\/)[\\s\\S]*?(?=\\/)/g);fetch(\"https://movie-database-imdb-alternative.p.rapidapi.com/?i=\"+link[0],{\"method\":\"GET\",\"headers\":{\"x-rapidapi-host\":\"movie-database-imdb-alternative.p.rapidapi.com\",\"x-rapidapi-key\":\"c3bfcbae69msh2fefac5f7da67adp1d2687jsnade70055f49b\"}}).then(function(response){response.json().then(function(data){apis.push(data);});}).catch(function(err){console.log(err);});});_this2.setState({apis:apis});}).catch(function(err){console.log(err);});case 2:auth.onAuthStateChanged(function(user){var currentState=_this2;if(user){currentState.setState({isSignedIn:true});}});case 3:case\"end\":return _context.stop();}}},_callee);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"setWatchList\",value:function setWatchList(id){var userRef=db.collection(\"user\").doc(auth.currentUser.email);var removeButtonList=this.state.removeButton;if(removeButtonList.indexOf(id)>-1){var addIndex=removeButtonList.indexOf(id);if(addIndex>-1){removeButtonList.splice(addIndex,1);}userRef.get().then(function(doc){var newWatchlist=doc.data().watchlist;var index=newWatchlist.indexOf(id);if(index>-1){newWatchlist.splice(index,1);}userRef.update({watchlist:newWatchlist});}).catch(function(error){console.log(error);});}else{removeButtonList.push(id);userRef.get().then(function(doc){var newWatchlist=doc.data().watchlist;newWatchlist.push(id);userRef.update({watchlist:newWatchlist});}).catch(function(error){console.log(error);});}this.setState({removeButton:removeButtonList});}},{key:\"handleWatchlist\",value:function handleWatchlist(){}},{key:\"render\",value:function render(){var _this3=this;var toggle=function toggle(tab){if(_this3.state.activeTab!==tab)_this3.setState({activeTab:tab});};var tabNames=[];return React.createElement(\"div\",null,React.createElement(\"h2\",{className:\"section-titles\"},\"Coming Sooooooon\"),React.createElement(\"div\",{className:\"tabs\"},React.createElement(Nav,{tabs:true},this.state.dates.map(function(item){var tabName=item.split(\" \")[1].slice(0,3)+\" \"+item.split(\" \")[2];if(tabNames.includes(tabName))return\"\";else{tabNames.push(tabName);return React.createElement(NavItem,{key:item,className:\"nav-items\"},React.createElement(\"a\",{className:classnames({active:_this3.state.activeTab===tabName}),onClick:function onClick(){toggle(tabName);}},React.createElement(\"button\",{className:\"tab-btn\"},tabName)));}})),React.createElement(TabContent,{activeTab:this.state.activeTab},tabNames.map(function(item){return React.createElement(TabPane,{tabId:item,key:item},React.createElement(Row,null,_this3.state.apis.filter(function(data){return data.Released.slice(3,11)===item;}).map(function(data){if(_this3.state.isSignedIn){var currentButtonList=_this3.state.removeButton;var currentState=_this3;db.collection(\"user\").doc(auth.currentUser.email).get().then(function(doc){var newWatchlist=doc.data().watchlist;var addIndex=newWatchlist.indexOf(data.imdbID);if(addIndex>-1){currentButtonList.push(data.imdbID);currentState.setState({removeButton:currentButtonList});}}).catch(function(error){console.log(\"Error getting document:\",error);});}return React.createElement(Col,{xl:\"6\",key:data.Title},React.createElement(Media,{className:\"media-body\"},React.createElement(Media,{left:true,className:\"media-pic\"},React.createElement(\"a\",{href:\"https://www.imdb.com/title/\"+data.imdbID,title:\"none clickbait\",rel:\"noopener noreferrer\",target:\"_blank\",className:\"media-pic\"},React.createElement(\"img\",{alt:data.Title,src:data.Poster}))),React.createElement(Media,{body:true,className:\"cards-body\"},React.createElement(CardTitle,null,React.createElement(NavLink,{to:{pathname:\"./Movie\",id:data.imdbID},className:\"card-title\",title:\"more info\"},data.Title),_this3.state.isSignedIn?React.createElement(\"button\",{className:\"watchlist-btn\",onClick:function onClick(){_this3.setWatchList(data.imdbID);}},_this3.state.removeButton.indexOf(data.imdbID)===-1?React.createElement(FiPlusSquare,null):React.createElement(FiMinusSquare,null)):\"\"),React.createElement(CardSubtitle,{className:\"card-subtitles\"},data.Rated,\" | \",data.Runtime,\" | \",data.Genre,\" |\",\" \",data.Released),React.createElement(CardText,{className:\"comingsoon-Card\"},\"Director: \",data.Director),React.createElement(CardText,{className:\"comingsoon-Card\"},\"Actors: \",data.Actors),React.createElement(CardText,{className:\"comingsoon-Plot\"},\"Plot: \",data.Plot))));})));}))));}}]);return ComingSoon;}(Component);export default ComingSoon;","map":{"version":3,"sources":["/home/lishi/Desktop/fullstack/movie-fanatic-club/src/components/comingSoon.js"],"names":["React","Component","CardText","CardTitle","CardSubtitle","TabContent","TabPane","Nav","NavItem","Row","Col","Media","classnames","rp","cheerio","FiPlusSquare","FiMinusSquare","NavLink","auth","db","ComingSoon","state","value","dates","activeTab","apis","isSignedIn","removeButton","handleWatchlist","bind","setWatchList","then","html","$","load","each","date","prepend","text","push","setState","name","attr","link","match","fetch","response","json","data","catch","err","console","log","onAuthStateChanged","user","currentState","id","userRef","collection","doc","currentUser","email","removeButtonList","indexOf","addIndex","splice","get","newWatchlist","watchlist","index","update","error","toggle","tab","tabNames","map","item","tabName","split","slice","includes","active","filter","Released","currentButtonList","imdbID","Title","Poster","pathname","Rated","Runtime","Genre","Director","Actors","Plot"],"mappings":"m1CAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OACEC,QADF,CAEEC,SAFF,CAGEC,YAHF,CAIEC,UAJF,CAKEC,OALF,CAMEC,GANF,CAOEC,OAPF,CAQEC,GARF,CASEC,GATF,CAUEC,KAVF,KAWO,YAXP,CAYA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,CACA,MAAOC,CAAAA,EAAP,KAAe,iBAAf,CACA,MAAOC,CAAAA,OAAP,KAAoB,SAApB,CACA,OAASC,YAAT,CAAuBC,aAAvB,KAA4C,gBAA5C,CACA,OAASC,OAAT,KAAwB,kBAAxB,CACA,OAASC,IAAT,CAAeC,EAAf,KAAyB,YAAzB,C,GAEMC,CAAAA,U,oEACJ,qBAAc,4CACZ,8EACA,MAAKC,KAAL,CAAa,CACXC,KAAK,CAAE,CADI,CAEXC,KAAK,CAAE,EAFI,CAGXC,SAAS,CAAE,EAHA,CAIXC,IAAI,CAAE,EAJK,CAKXC,UAAU,CAAE,KALD,CAMXC,YAAY,CAAE,EANH,CAAb,CASA,MAAKC,eAAL,CAAuB,MAAKA,eAAL,CAAqBC,IAArB,+BAAvB,CACA,MAAKC,YAAL,CAAoB,MAAKA,YAAL,CAAkBD,IAAlB,+BAApB,CAZY,aAab,C,2TAGOhB,CAAAA,EAAE,CACN,sFADM,CAAF,CAGHkB,IAHG,CAGE,SAAAC,IAAI,CAAI,CACZ,GAAIT,CAAAA,KAAK,CAAG,EAAZ,CACEE,IAAI,CAAG,EADT,CAEA,GAAIQ,CAAAA,CAAC,CAAGnB,OAAO,CAACoB,IAAR,CAAaF,IAAb,CAAR,CAEAC,CAAC,CAAC,UAAD,CAAD,CAAcE,IAAd,CAAmB,UAAY,CAC7B,GAAIC,CAAAA,IAAI,CAAGH,CAAC,CAAC,IAAD,CAAD,CACRI,OADQ,GAERC,IAFQ,EAAX,CAIAf,KAAK,CAACgB,IAAN,CAAWH,IAAX,EACD,CAND,EAOA,MAAI,CAACI,QAAL,CAAc,CACZjB,KAAK,CAAEA,KADK,CAAd,EAIAU,CAAC,CAAC,eAAD,CAAD,CAAmBE,IAAnB,CAAwB,UAAY,CAClC,GAAIM,CAAAA,IAAI,CAAGR,CAAC,CAAC,IAAD,CAAD,CAAQS,IAAR,CAAa,MAAb,CAAX,CACA,GAAIC,CAAAA,IAAI,CAAGF,IAAI,CAACG,KAAL,CAAW,6BAAX,CAAX,CAEAC,KAAK,CAAC,6DAA+DF,IAAI,CAAC,CAAD,CAApE,CAAyE,CAC5E,SAAU,KADkE,CAE5E,UAAW,CACT,kBAAmB,gDADV,CAET,iBAAkB,oDAFT,CAFiE,CAAzE,CAAL,CAMGZ,IANH,CAMQ,SAAAe,QAAQ,CAAI,CAChBA,QAAQ,CAACC,IAAT,GAAgBhB,IAAhB,CAAqB,SAAAiB,IAAI,CAAI,CAC3BvB,IAAI,CAACc,IAAL,CAAUS,IAAV,EACD,CAFD,EAGD,CAVH,EAWGC,KAXH,CAWS,SAAAC,GAAG,CAAI,CACZC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACD,CAbH,EAcD,CAlBD,EAmBA,MAAI,CAACV,QAAL,CAAc,CACZf,IAAI,CAAEA,IADM,CAAd,EAGD,CAzCG,EA0CHwB,KA1CG,CA0CG,SAAUC,GAAV,CAAe,CACpBC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACD,CA5CG,C,QA8CNhC,IAAI,CAACmC,kBAAL,CAAwB,SAAAC,IAAI,CAAI,CAC9B,GAAIC,CAAAA,YAAY,CAAG,MAAnB,CACA,GAAID,IAAJ,CAAU,CACRC,YAAY,CAACf,QAAb,CAAsB,CACpBd,UAAU,CAAC,IADS,CAAtB,EAGD,CACF,CAPD,E,qNAUW8B,E,CAAG,CACd,GAAIC,CAAAA,OAAO,CAAGtC,EAAE,CAACuC,UAAH,CAAc,MAAd,EAAsBC,GAAtB,CAA0BzC,IAAI,CAAC0C,WAAL,CAAiBC,KAA3C,CAAd,CACA,GAAIC,CAAAA,gBAAgB,CAAG,KAAKzC,KAAL,CAAWM,YAAlC,CACA,GAAImC,gBAAgB,CAACC,OAAjB,CAAyBP,EAAzB,EAA+B,CAAC,CAApC,CAAuC,CACrC,GAAIQ,CAAAA,QAAQ,CAAGF,gBAAgB,CAACC,OAAjB,CAAyBP,EAAzB,CAAf,CACA,GAAIQ,QAAQ,CAAG,CAAC,CAAhB,CAAmB,CACbF,gBAAgB,CAACG,MAAjB,CAAwBD,QAAxB,CAAkC,CAAlC,EACL,CACDP,OAAO,CACJS,GADH,GAEGnC,IAFH,CAEQ,SAAU4B,GAAV,CAAe,CACnB,GAAIQ,CAAAA,YAAY,CAAGR,GAAG,CAACX,IAAJ,GAAWoB,SAA9B,CACA,GAAIC,CAAAA,KAAK,CAAGF,YAAY,CAACJ,OAAb,CAAqBP,EAArB,CAAZ,CACA,GAAIa,KAAK,CAAG,CAAC,CAAb,CAAgB,CACdF,YAAY,CAACF,MAAb,CAAoBI,KAApB,CAA2B,CAA3B,EACD,CACDZ,OAAO,CAACa,MAAR,CAAe,CACbF,SAAS,CAAED,YADE,CAAf,EAGD,CAXH,EAYGlB,KAZH,CAYS,SAAUsB,KAAV,CAAiB,CACtBpB,OAAO,CAACC,GAAR,CAAYmB,KAAZ,EACD,CAdH,EAeD,CApBD,IAqBK,CACHT,gBAAgB,CAACvB,IAAjB,CAAsBiB,EAAtB,EACAC,OAAO,CACJS,GADH,GAEGnC,IAFH,CAEQ,SAAU4B,GAAV,CAAe,CACnB,GAAIQ,CAAAA,YAAY,CAAGR,GAAG,CAACX,IAAJ,GAAWoB,SAA9B,CACAD,YAAY,CAAC5B,IAAb,CAAkBiB,EAAlB,EACAC,OAAO,CAACa,MAAR,CAAe,CACbF,SAAS,CAAED,YADE,CAAf,EAGD,CARH,EASGlB,KATH,CASS,SAAUsB,KAAV,CAAiB,CACtBpB,OAAO,CAACC,GAAR,CAAYmB,KAAZ,EACD,CAXH,EAYD,CACD,KAAK/B,QAAL,CAAc,CAACb,YAAY,CAAEmC,gBAAf,CAAd,EACD,C,yDAEiB,CAAG,C,uCAEZ,iBACP,GAAMU,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAAAC,GAAG,CAAI,CACpB,GAAI,MAAI,CAACpD,KAAL,CAAWG,SAAX,GAAyBiD,GAA7B,CAAkC,MAAI,CAACjC,QAAL,CAAc,CAAEhB,SAAS,CAAEiD,GAAb,CAAd,EACnC,CAFD,CAIA,GAAIC,CAAAA,QAAQ,CAAG,EAAf,CAEA,MACE,gCACE,0BAAI,SAAS,CAAC,gBAAd,qBADF,CAEE,2BAAK,SAAS,CAAC,MAAf,EACE,oBAAC,GAAD,EAAK,IAAI,KAAT,EACG,KAAKrD,KAAL,CAAWE,KAAX,CAAiBoD,GAAjB,CAAqB,SAAAC,IAAI,CAAI,CAC5B,GAAMC,CAAAA,OAAO,CACXD,IAAI,CAACE,KAAL,CAAW,GAAX,EAAgB,CAAhB,EAAmBC,KAAnB,CAAyB,CAAzB,CAA4B,CAA5B,EAAiC,GAAjC,CAAuCH,IAAI,CAACE,KAAL,CAAW,GAAX,EAAgB,CAAhB,CADzC,CAEA,GAAIJ,QAAQ,CAACM,QAAT,CAAkBH,OAAlB,CAAJ,CAAgC,MAAO,EAAP,CAAhC,IACK,CACHH,QAAQ,CAACnC,IAAT,CAAcsC,OAAd,EACA,MACE,qBAAC,OAAD,EAAS,GAAG,CAAED,IAAd,CAAoB,SAAS,CAAC,WAA9B,EACE,yBACE,SAAS,CAAEhE,UAAU,CAAC,CACpBqE,MAAM,CAAE,MAAI,CAAC5D,KAAL,CAAWG,SAAX,GAAyBqD,OADb,CAAD,CADvB,CAIE,OAAO,CAAE,kBAAM,CACbL,MAAM,CAACK,OAAD,CAAN,CACD,CANH,EAQE,8BAAQ,SAAS,CAAC,SAAlB,EAA6BA,OAA7B,CARF,CADF,CADF,CAcD,CACF,CArBA,CADH,CADF,CAyBE,oBAAC,UAAD,EAAY,SAAS,CAAE,KAAKxD,KAAL,CAAWG,SAAlC,EACGkD,QAAQ,CAACC,GAAT,CAAa,SAAAC,IAAI,CAAI,CACpB,MACE,qBAAC,OAAD,EAAS,KAAK,CAAEA,IAAhB,CAAsB,GAAG,CAAEA,IAA3B,EACE,oBAAC,GAAD,MACG,MAAI,CAACvD,KAAL,CAAWI,IAAX,CACEyD,MADF,CACS,SAAAlC,IAAI,QAAIA,CAAAA,IAAI,CAACmC,QAAL,CAAcJ,KAAd,CAAoB,CAApB,CAAuB,EAAvB,IAA+BH,IAAnC,EADb,EAEED,GAFF,CAEM,SAAA3B,IAAI,CAAI,CAEX,GAAI,MAAI,CAAC3B,KAAL,CAAWK,UAAf,CAA0B,CACxB,GAAI0D,CAAAA,iBAAiB,CAAG,MAAI,CAAC/D,KAAL,CAAWM,YAAnC,CACA,GAAI4B,CAAAA,YAAY,CAAG,MAAnB,CACApC,EAAE,CAACuC,UAAH,CAAc,MAAd,EAAsBC,GAAtB,CAA0BzC,IAAI,CAAC0C,WAAL,CAAiBC,KAA3C,EACOK,GADP,GAEOnC,IAFP,CAEY,SAAU4B,GAAV,CAAe,CACnB,GAAIQ,CAAAA,YAAY,CAAGR,GAAG,CAACX,IAAJ,GAAWoB,SAA9B,CACA,GAAIJ,CAAAA,QAAQ,CAAGG,YAAY,CAACJ,OAAb,CAAqBf,IAAI,CAACqC,MAA1B,CAAf,CACA,GAAIrB,QAAQ,CAAG,CAAC,CAAhB,CAAmB,CACjBoB,iBAAiB,CAAC7C,IAAlB,CAAuBS,IAAI,CAACqC,MAA5B,EACA9B,YAAY,CAACf,QAAb,CAAsB,CACpBb,YAAY,CAAEyD,iBADM,CAAtB,EAGD,CAEF,CAZP,EAaOnC,KAbP,CAaa,SAASsB,KAAT,CAAgB,CACrBpB,OAAO,CAACC,GAAR,CAAY,yBAAZ,CAAuCmB,KAAvC,EACD,CAfP,EAgBC,CAEH,MACE,qBAAC,GAAD,EAAK,EAAE,CAAC,GAAR,CAAY,GAAG,CAAEvB,IAAI,CAACsC,KAAtB,EACE,oBAAC,KAAD,EAAO,SAAS,CAAC,YAAjB,EACE,oBAAC,KAAD,EAAO,IAAI,KAAX,CAAY,SAAS,CAAC,WAAtB,EACE,yBACE,IAAI,CACF,8BAAgCtC,IAAI,CAACqC,MAFzC,CAIE,KAAK,CAAC,gBAJR,CAKE,GAAG,CAAC,qBALN,CAME,MAAM,CAAC,QANT,CAOE,SAAS,CAAC,WAPZ,EASE,2BAAK,GAAG,CAAErC,IAAI,CAACsC,KAAf,CAAsB,GAAG,CAAEtC,IAAI,CAACuC,MAAhC,EATF,CADF,CADF,CAcE,oBAAC,KAAD,EAAO,IAAI,KAAX,CAAY,SAAS,CAAC,YAAtB,EACE,oBAAC,SAAD,MACE,oBAAC,OAAD,EACE,EAAE,CAAE,CACFC,QAAQ,CAAE,SADR,CAEFhC,EAAE,CAAER,IAAI,CAACqC,MAFP,CADN,CAKE,SAAS,CAAC,YALZ,CAME,KAAK,CAAC,WANR,EAQGrC,IAAI,CAACsC,KARR,CADF,CAWG,MAAI,CAACjE,KAAL,CAAWK,UAAX,CACD,8BACE,SAAS,CAAC,eADZ,CAEE,OAAO,CAAE,kBAAM,CACb,MAAI,CAACI,YAAL,CAAkBkB,IAAI,CAACqC,MAAvB,EACD,CAJH,EAMG,MAAI,CAAChE,KAAL,CAAWM,YAAX,CAAwBoC,OAAxB,CAAgCf,IAAI,CAACqC,MAArC,IAA+C,CAAC,CAAhD,CAAkD,oBAAC,YAAD,MAAlD,CAAmE,oBAAC,aAAD,MANtE,CADC,CASA,EApBH,CADF,CAuBE,oBAAC,YAAD,EAAc,SAAS,CAAC,gBAAxB,EACGrC,IAAI,CAACyC,KADR,OACkBzC,IAAI,CAAC0C,OADvB,OACmC1C,IAAI,CAAC2C,KADxC,MACiD,GADjD,CAEG3C,IAAI,CAACmC,QAFR,CAvBF,CA2BE,oBAAC,QAAD,EAAU,SAAS,CAAC,iBAApB,eAAiDnC,IAAI,CAAC4C,QAAtD,CA3BF,CA4BE,oBAAC,QAAD,EAAU,SAAS,CAAC,iBAApB,aAA+C5C,IAAI,CAAC6C,MAApD,CA5BF,CA6BE,oBAAC,QAAD,EAAU,SAAS,CAAC,iBAApB,WAA6C7C,IAAI,CAAC8C,IAAlD,CA7BF,CAdF,CADF,CADF,CAkDD,CA3EF,CADH,CADF,CADF,CAkFD,CAnFA,CADH,CAzBF,CAFF,CADF,CAqHD,C,wBAjPsB7F,S,EAoPzB,cAAemB,CAAAA,UAAf","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  CardText,\n  CardTitle,\n  CardSubtitle,\n  TabContent,\n  TabPane,\n  Nav,\n  NavItem,\n  Row,\n  Col,\n  Media\n} from \"reactstrap\";\nimport classnames from 'classnames';\nimport rp from \"request-promise\";\nimport cheerio from \"cheerio\";\nimport { FiPlusSquare, FiMinusSquare } from \"react-icons/fi\";\nimport { NavLink } from \"react-router-dom\";\nimport { auth, db } from \"./Firebase\";\n\nclass ComingSoon extends Component {\n  constructor() {\n    super();\n    this.state = {\n      value: 0,\n      dates: [],\n      activeTab: \"\",\n      apis: [],\n      isSignedIn: false,\n      removeButton: []\n    };\n\n    this.handleWatchlist = this.handleWatchlist.bind(this);\n    this.setWatchList = this.setWatchList.bind(this);\n  }\n\n  async componentDidMount() {\n    await rp(\n      \"https://cors-anywhere.herokuapp.com/https://www.imdb.com/calendar?region=US&ref_=rlm\"\n    )\n      .then(html => {\n        let dates = [],\n          apis = [];\n        let $ = cheerio.load(html);\n\n        $(\"#main h4\").each(function () {\n          let date = $(this)\n            .prepend()\n            .text();\n\n          dates.push(date);\n        });\n        this.setState({\n          dates: dates\n        });\n\n        $(\"#main ul li a\").each(function () {\n          let name = $(this).attr(\"href\");\n          let link = name.match(/(?<=title\\/).*?(?=\\/)/gs);\n\n          fetch(\"https://movie-database-imdb-alternative.p.rapidapi.com/?i=\" + link[0], {\n            \"method\": \"GET\",\n            \"headers\": {\n              \"x-rapidapi-host\": \"movie-database-imdb-alternative.p.rapidapi.com\",\n              \"x-rapidapi-key\": \"c3bfcbae69msh2fefac5f7da67adp1d2687jsnade70055f49b\"\n            }})\n            .then(response => {\n              response.json().then(data => {\n                apis.push(data);\n              });\n            })\n            .catch(err => {\n              console.log(err);\n            });\n        });\n        this.setState({\n          apis: apis\n        });\n      })\n      .catch(function (err) {\n        console.log(err);\n      });\n\n    auth.onAuthStateChanged(user => {\n      let currentState = this\n      if (user) {\n        currentState.setState({\n          isSignedIn:true\n        })\n      }\n    })\n  }\n\n  setWatchList(id){\n    let userRef = db.collection(\"user\").doc(auth.currentUser.email)\n    let removeButtonList = this.state.removeButton\n    if (removeButtonList.indexOf(id) > -1) {\n      var addIndex = removeButtonList.indexOf(id)\n      if (addIndex > -1) {\n            removeButtonList.splice(addIndex, 1)\n      }\n      userRef\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          var index = newWatchlist.indexOf(id)\n          if (index > -1) {\n            newWatchlist.splice(index, 1)\n          }\n          userRef.update({\n            watchlist: newWatchlist\n          })\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    }\n    else {\n      removeButtonList.push(id)\n      userRef\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          newWatchlist.push(id)\n          userRef.update({\n            watchlist: newWatchlist\n          })\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    }\n    this.setState({removeButton: removeButtonList})\n  }\n\n  handleWatchlist() { }\n\n  render() {\n    const toggle = tab => {\n      if (this.state.activeTab !== tab) this.setState({ activeTab: tab });\n    };\n\n    var tabNames = [];\n\n    return (\n      <div>\n        <h2 className=\"section-titles\">Coming Sooooooon</h2>\n        <div className=\"tabs\">\n          <Nav tabs>\n            {this.state.dates.map(item => {\n              const tabName =\n                item.split(\" \")[1].slice(0, 3) + \" \" + item.split(\" \")[2];\n              if (tabNames.includes(tabName)) return \"\";\n              else {\n                tabNames.push(tabName);\n                return (\n                  <NavItem key={item} className=\"nav-items\">\n                    <a\n                      className={classnames({\n                        active: this.state.activeTab === tabName\n                      })}\n                      onClick={() => {\n                        toggle(tabName);\n                      }}\n                    >\n                      <button className=\"tab-btn\">{tabName}</button>\n                    </a>\n                  </NavItem>\n                );\n              }\n            })}\n          </Nav>\n          <TabContent activeTab={this.state.activeTab}>\n            {tabNames.map(item => {\n              return (\n                <TabPane tabId={item} key={item}>\n                  <Row>\n                    {this.state.apis\n                      .filter(data => data.Released.slice(3, 11) === item)\n                      .map(data => {\n\n                        if (this.state.isSignedIn){\n                          var currentButtonList = this.state.removeButton\n                          var currentState = this\n                          db.collection(\"user\").doc(auth.currentUser.email)\n                                .get()\n                                .then(function (doc) {\n                                  var newWatchlist = doc.data().watchlist;\n                                  var addIndex = newWatchlist.indexOf(data.imdbID)\n                                  if (addIndex > -1) {\n                                    currentButtonList.push(data.imdbID)\n                                    currentState.setState({\n                                      removeButton: currentButtonList\n                                    })\n                                  }\n                        \n                                })\n                                .catch(function(error) {\n                                  console.log(\"Error getting document:\", error);\n                                });\n                          }  \n                        \n                        return (\n                          <Col xl=\"6\" key={data.Title}>\n                            <Media className=\"media-body\">\n                              <Media left className=\"media-pic\">\n                                <a\n                                  href={\n                                    \"https://www.imdb.com/title/\" + data.imdbID\n                                  }\n                                  title=\"none clickbait\"\n                                  rel=\"noopener noreferrer\"\n                                  target=\"_blank\"\n                                  className=\"media-pic\"\n                                >\n                                  <img alt={data.Title} src={data.Poster} />\n                                </a>\n                              </Media>\n                              <Media body className=\"cards-body\">\n                                <CardTitle>\n                                  <NavLink\n                                    to={{\n                                      pathname: \"./Movie\",\n                                      id: data.imdbID\n                                    }}\n                                    className=\"card-title\"\n                                    title=\"more info\"\n                                  >\n                                    {data.Title}\n                                  </NavLink>\n                                  {this.state.isSignedIn?\n                                  <button \n                                    className=\"watchlist-btn\" \n                                    onClick={() => {\n                                      this.setWatchList(data.imdbID)\n                                    }}\n                                  >\n                                    {this.state.removeButton.indexOf(data.imdbID)===-1?<FiPlusSquare />:<FiMinusSquare />}\n                                  </button>\n                                  :\"\"}\n                                </CardTitle>\n                                <CardSubtitle className=\"card-subtitles\">\n                                  {data.Rated} | {data.Runtime} | {data.Genre} |{\" \"}\n                                  {data.Released}\n                                </CardSubtitle>\n                                <CardText className=\"comingsoon-Card\">Director: {data.Director}</CardText>\n                                <CardText className=\"comingsoon-Card\">Actors: {data.Actors}</CardText>\n                                <CardText className=\"comingsoon-Plot\">Plot: {data.Plot}</CardText>\n                              </Media>\n                            </Media>\n                          </Col>\n                        );\n                      })}\n                  </Row>\n                </TabPane>\n              );\n            })}\n          </TabContent>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ComingSoon;\n"]},"metadata":{},"sourceType":"module"}