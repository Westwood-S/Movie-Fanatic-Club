{"ast":null,"code":"import _classCallCheck from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";// body component for loading stuff about an individual movie\n// when the user clicks on it\nimport React from\"react\";import\"../index.css\";import{Media,Container,Row,Button}from\"reactstrap\";import{TiPlusOutline,TiMinusOutline}from\"react-icons/ti\";import{auth,db}from\"./Firebase\";import firebase from\"firebase\";var Movie=/*#__PURE__*/function(_React$Component){_inherits(Movie,_React$Component);function Movie(props){var _this;_classCallCheck(this,Movie);_this=_possibleConstructorReturn(this,_getPrototypeOf(Movie).call(this,props));_this.state={movie:{},movies:{},loading:true,isAdd:false,thisMovie:\"\"};_this.addToWatchlist=_this.addToWatchlist.bind(_assertThisInitialized(_this));_this.removeFromWatchlist=_this.removeFromWatchlist.bind(_assertThisInitialized(_this));return _this;}_createClass(Movie,[{key:\"addToWatchlist\",value:function addToWatchlist(){var watchlistRef=db.collection(\"user\").doc(auth.currentUser.email);watchlistRef.update({watchlist:firebase.firestore.FieldValue.arrayUnion(this.state.movie.id)});alert(\"adding to watchlist\");this.setWatchList=this.setWatchList.bind(this);this.checkExists=this.checkExists.bind(this);}},{key:\"removeFromWatchlist\",value:function removeFromWatchlist(){var watchlistRef=db.collection(\"user\").doc(auth.currentUser.email);watchlistRef.update({watchlist:firebase.firestore.FieldValue.arrayRemove(this.state.movie.id)});alert(\"removing from watchlist\");}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch(\"https://imdb-internet-movie-database-unofficial.p.rapidapi.com/film/\"+this.props.location.id,{method:\"GET\",headers:{\"x-rapidapi-host\":\"imdb-internet-movie-database-unofficial.p.rapidapi.com\",\"x-rapidapi-key\":\"c3bfcbae69msh2fefac5f7da67adp1d2687jsnade70055f49b\"}}).then(function(response){response.json().then(function(data){_this2.setState({movie:data,thisMovie:data.id});});}).catch(function(err){console.log(err);});fetch(\"https://www.omdbapi.com/?apikey=1e54e73e&i=\"+this.props.location.id).then(function(response){response.json().then(function(data){_this2.setState({movies:data});});}).catch(function(err){console.log(err);});auth.onAuthStateChanged(function(user){if(user){var docRef=db.collection(\"user\").doc(auth.currentUser.email);docRef.get().then(function(doc){var newWatchlist=doc.data().watchlist;var index=newWatchlist.indexOf(this.state.thisMovie);if(index>-1){this.setState({isAdd:true});}}).catch(function(error){console.log(\"Error getting document:\",error);});}});}/* checkExists(id) {\n    if (this.state.isAdd === \"false\") {\n      console.log(\"isadd\")\n      db.collection(\"user\")\n        .doc(auth.currentUser.email)\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          var index = newWatchlist.indexOf(id)\n          if (index > -1) {\n            this.setState({\n              isAdd: true\n            })\n          }\n\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n\n      this.setState({\n        isAdd: !this.state.isAdd\n      })\n    }\n  } */},{key:\"setWatchList\",value:function setWatchList(id){var userRef=db.collection(\"user\").doc(auth.currentUser.email);if(this.state.isAdd){userRef.get().then(function(doc){var newWatchlist=doc.data().watchlist;var index=newWatchlist.indexOf(id);if(index>-1){newWatchlist.splice(index,1);}userRef.update({watchlist:newWatchlist});}).catch(function(error){console.log(error);});this.setState({isAdd:!this.state.isAdd});}else{userRef.get().then(function(doc){var newWatchlist=doc.data().watchlist;newWatchlist.push(id);userRef.update({watchlist:newWatchlist});}).catch(function(error){console.log(error);});this.setState({isAdd:!this.state.isAdd});}}},{key:\"render\",value:function render(){var _this3=this;if(this.state.isAdd==='false'&&this.state.movie.id){console.log(\"check\");db.collection(\"user\").doc(auth.currentUser.email).get().then(function(doc){var newWatchlist=doc.data().watchlist;var index=newWatchlist.indexOf(this.state.movie.id);if(index>-1){this.setState({isAdd:true});}}).catch(function(error){console.log(error);});}return React.createElement(Container,null,this.state.movie?React.createElement(\"div\",null,React.createElement(Row,null,React.createElement(\"a\",{title:\"if u stan imdb...\",className:\"movie-title\",rel:\"noopener noreferrer\",target:\"_blank\",href:\"https://www.imdb.com/title/\"+this.state.movie.id},this.state.movie.title,\" (\",this.state.movie.year,\")\")),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-poster\"},this.state.movie.poster?React.createElement(\"a\",{title:\"trailer is here!\",className:\"movie-title\",rel:\"noopener noreferrer\",target:\"_blank\",href:this.state.movie.trailer?this.state.movie.trailer.link:\"/\"},React.createElement(\"img\",{className:\"movie-actual-poster\",alt:this.state.movie.title,src:this.state.movie.poster})):\"\")),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-director\"},\"directed by: \",this.state.movies.Director)),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},this.state.movies.Rated,\" | \",this.state.movies.Runtime,\" | \",this.state.movies.Released)),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},this.state.movies.Country,\" | \",this.state.movies.Language)),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},\"IMDb rating: \",this.state.movies.imdbRating,\" | Metascore: \",this.state.movies.Metascore)),this.state.movies.Production?React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-director\"},\"this.state.movies.Production\")):\"\",React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},\"AWARDS: \",this.state.movies.Awards)),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},\"PLOT: \",this.state.movies.Plot)),this.state.movie.cast?this.state.movie.cast.map(function(item){return React.createElement(Row,{key:\"\"},React.createElement(\"div\",{className:\"movie-actor\"},React.createElement(\"a\",{title:\"visit fav actor\",className:\"movie-actor-link\",rel:\"noopener noreferrer\",target:\"_blank\",href:'https://www.imdb.com/name/'+item.actor_id},item.actor),\" as \",item.character));}):\"\",React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-btn\"},React.createElement(Button,{onClick:function onClick(){_this3.setWatchList(_this3.state.movie.id);},className:\"movie-rl-btn\"},this.state.isAdd?React.createElement(TiMinusOutline,null):React.createElement(TiPlusOutline,null),\"watchlist\")))):React.createElement(Media,null,\"wait a sec bru\"));}}]);return Movie;}(React.Component);export default Movie;","map":{"version":3,"sources":["/home/lishi/Desktop/fullstack/movie-fanatic-club/src/components/Movie.js"],"names":["React","Media","Container","Row","Button","TiPlusOutline","TiMinusOutline","auth","db","firebase","Movie","props","state","movie","movies","loading","isAdd","thisMovie","addToWatchlist","bind","removeFromWatchlist","watchlistRef","collection","doc","currentUser","email","update","watchlist","firestore","FieldValue","arrayUnion","id","alert","setWatchList","checkExists","arrayRemove","fetch","location","method","headers","then","response","json","data","setState","catch","err","console","log","onAuthStateChanged","user","docRef","get","newWatchlist","index","indexOf","error","userRef","splice","push","title","year","poster","trailer","link","Director","Rated","Runtime","Released","Country","Language","imdbRating","Metascore","Production","Awards","Plot","cast","map","item","actor_id","actor","character","Component"],"mappings":"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","sourcesContent":["// body component for loading stuff about an individual movie\n// when the user clicks on it\n\nimport React from \"react\";\nimport \"../index.css\";\nimport { Media, Container, Row, Button } from \"reactstrap\";\nimport { TiPlusOutline, TiMinusOutline } from \"react-icons/ti\";\nimport { auth, db } from \"./Firebase\";\nimport firebase from \"firebase\";\n\nclass Movie extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      movie: {},\n      movies: {},\n      loading: true,\n      isAdd: false,\n      thisMovie: \"\"\n    };\n\n    this.addToWatchlist = this.addToWatchlist.bind(this);\n    this.removeFromWatchlist = this.removeFromWatchlist.bind(this);\n  }\n\n  addToWatchlist() {\n    var watchlistRef = db.collection(\"user\").doc(auth.currentUser.email);\n    watchlistRef.update({\n      watchlist: firebase.firestore.FieldValue.arrayUnion(this.state.movie.id)\n    });\n    alert(\"adding to watchlist\");\n    this.setWatchList = this.setWatchList.bind(this)\n    this.checkExists = this.checkExists.bind(this)\n  }\n\n  removeFromWatchlist() {\n    var watchlistRef = db.collection(\"user\").doc(auth.currentUser.email);\n    watchlistRef.update({\n      watchlist: firebase.firestore.FieldValue.arrayRemove(this.state.movie.id)\n    });\n    alert(\"removing from watchlist\");\n  }\n\n  componentDidMount() {\n    fetch(\n      \"https://imdb-internet-movie-database-unofficial.p.rapidapi.com/film/\" +\n      this.props.location.id,\n      {\n        method: \"GET\",\n        headers: {\n          \"x-rapidapi-host\":\n            \"imdb-internet-movie-database-unofficial.p.rapidapi.com\",\n          \"x-rapidapi-key\": \"c3bfcbae69msh2fefac5f7da67adp1d2687jsnade70055f49b\"\n        }\n      }\n    )\n      .then(response => {\n        response.json().then(data => {\n          this.setState({\n            movie: data,\n            thisMovie: data.id\n          })\n        })\n      })\n      .catch(err => {\n        console.log(err);\n      });\n\n    fetch(\n      \"https://www.omdbapi.com/?apikey=1e54e73e&i=\" + this.props.location.id\n    )\n      .then(response => {\n        response.json().then(data => {\n          this.setState({\n            movies: data\n          })\n        })\n      })\n      .catch(err => {\n        console.log(err);\n      });\n\n    auth.onAuthStateChanged(user => {\n      if (user) {\n        var docRef = db.collection(\"user\").doc(auth.currentUser.email);\n          docRef\n            .get()\n            .then(function (doc) {\n              var newWatchlist = doc.data().watchlist;\n              var index = newWatchlist.indexOf(this.state.thisMovie)\n              if (index > -1) {\n                this.setState({\n                  isAdd: true\n                })\n              }\n    \n            })\n            .catch(function(error) {\n              console.log(\"Error getting document:\", error);\n            });\n      }\n    })\n  }\n\n\n  /* checkExists(id) {\n    if (this.state.isAdd === \"false\") {\n      console.log(\"isadd\")\n      db.collection(\"user\")\n        .doc(auth.currentUser.email)\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          var index = newWatchlist.indexOf(id)\n          if (index > -1) {\n            this.setState({\n              isAdd: true\n            })\n          }\n\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n\n      this.setState({\n        isAdd: !this.state.isAdd\n      })\n    }\n  } */\n\n  setWatchList(id) {\n    let userRef = db.collection(\"user\").doc(auth.currentUser.email)\n    if (this.state.isAdd) {\n      userRef\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          var index = newWatchlist.indexOf(id)\n          if (index > -1) {\n            newWatchlist.splice(index, 1)\n          }\n          userRef.update({\n            watchlist: newWatchlist\n          })\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n\n      this.setState({\n        isAdd: !this.state.isAdd\n      })\n    }\n    else {\n      userRef\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          newWatchlist.push(id)\n          userRef.update({\n            watchlist: newWatchlist\n          })\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n\n      this.setState({\n        isAdd: !this.state.isAdd\n      })\n    }\n  }\n\n  render() {\n    if (this.state.isAdd === 'false' && this.state.movie.id) {\n      console.log(\"check\")\n      db.collection(\"user\")\n        .doc(auth.currentUser.email)\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          var index = newWatchlist.indexOf(this.state.movie.id)\n          if (index > -1) {\n            this.setState({\n              isAdd: true\n            })\n          }\n\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n    }\n\n    return (\n      <Container>\n        {this.state.movie ?\n          <div>\n            <Row>\n              <a title=\"if u stan imdb...\" className=\"movie-title\" rel=\"noopener noreferrer\" target=\"_blank\" href={\"https://www.imdb.com/title/\" + this.state.movie.id}>{this.state.movie.title} ({this.state.movie.year})</a>\n            </Row>\n            <Row>\n              <div className=\"movie-poster\">\n                {this.state.movie.poster ?\n                  <a title=\"trailer is here!\" className=\"movie-title\" rel=\"noopener noreferrer\" target=\"_blank\" href={this.state.movie.trailer ? this.state.movie.trailer.link : \"/\"}>\n                    <img className=\"movie-actual-poster\" alt={this.state.movie.title} src={this.state.movie.poster} />\n                  </a>\n                  : \"\"}\n\n              </div>\n            </Row>\n            <Row><div className=\"movie-director\">directed by: {this.state.movies.Director}</div></Row>\n            <Row><div className=\"movie-info\">{this.state.movies.Rated} | {this.state.movies.Runtime} | {this.state.movies.Released}</div></Row>\n            <Row><div className=\"movie-info\">{this.state.movies.Country} | {this.state.movies.Language}</div></Row>\n            <Row><div className=\"movie-info\">IMDb rating: {this.state.movies.imdbRating} | Metascore: {this.state.movies.Metascore}</div></Row>\n            {this.state.movies.Production ?\n              <Row><div className=\"movie-director\">this.state.movies.Production</div></Row> : \"\"}\n            <Row><div className=\"movie-info\">AWARDS: {this.state.movies.Awards}</div></Row>\n            <Row><div className=\"movie-info\">PLOT: {this.state.movies.Plot}</div></Row>\n            {this.state.movie.cast ?\n              this.state.movie.cast.map(item => {\n                return (\n                  <Row key=\"\"><div className=\"movie-actor\">\n                    <a title=\"visit fav actor\" className=\"movie-actor-link\" rel=\"noopener noreferrer\" target=\"_blank\" href={'https://www.imdb.com/name/' + item.actor_id}>{item.actor}</a> as {item.character}\n                  </div></Row>\n                )\n              })\n              : \"\"}\n            <Row>\n              <div className=\"movie-btn\">\n                <Button\n                  onClick={() => {\n                    this.setWatchList(this.state.movie.id)\n                  }}\n                  className=\"movie-rl-btn\">{this.state.isAdd ? <TiMinusOutline /> : <TiPlusOutline />}\n                watchlist\n              </Button>\n\n              </div>\n            </Row>\n          </div>\n          : <Media>wait a sec bru</Media>}\n      </Container>\n    );\n  }\n}\n\nexport default Movie;\n"]},"metadata":{},"sourceType":"module"}