{"ast":null,"code":"import _regeneratorRuntime from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/lishi/Desktop/fullstack/movie-fanatic-club/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";// body component for loading stuff about an individual movie\n// when the user clicks on it\nimport React from\"react\";import\"../index.css\";import{Media,Container,Row,Button}from\"reactstrap\";import{TiPlusOutline,TiMinusOutline}from\"react-icons/ti\";import{auth,db}from\"./Firebase\";import firebase from\"firebase\";var Movie=/*#__PURE__*/function(_React$Component){_inherits(Movie,_React$Component);function Movie(props){var _this;_classCallCheck(this,Movie);_this=_possibleConstructorReturn(this,_getPrototypeOf(Movie).call(this,props));_this.state={movie:{},movies:{},loading:true,isAdd:false,thisMovie:\"\",isMounted:false};_this.addToWatchlist=_this.addToWatchlist.bind(_assertThisInitialized(_this));_this.removeFromWatchlist=_this.removeFromWatchlist.bind(_assertThisInitialized(_this));return _this;}_createClass(Movie,[{key:\"addToWatchlist\",value:function addToWatchlist(){var watchlistRef=db.collection(\"user\").doc(auth.currentUser.email);watchlistRef.update({watchlist:firebase.firestore.FieldValue.arrayUnion(this.state.movie.id)});alert(\"adding to watchlist\");this.setWatchList=this.setWatchList.bind(this);this.checkExists=this.checkExists.bind(this);}},{key:\"removeFromWatchlist\",value:function removeFromWatchlist(){var watchlistRef=db.collection(\"user\").doc(auth.currentUser.email);watchlistRef.update({watchlist:firebase.firestore.FieldValue.arrayRemove(this.state.movie.id)});alert(\"removing from watchlist\");}},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.setState({isMounted:true});fetch(\"https://imdb-internet-movie-database-unofficial.p.rapidapi.com/film/\"+this.props.location.id,{method:\"GET\",headers:{\"x-rapidapi-host\":\"imdb-internet-movie-database-unofficial.p.rapidapi.com\",\"x-rapidapi-key\":\"c3bfcbae69msh2fefac5f7da67adp1d2687jsnade70055f49b\"}}).then(function(response){response.json().then(function(data){_this2.setState({movie:data,thisMovie:data.id});auth.onAuthStateChanged(function(user){var currentState=_this2,thisMovie=currentState.state.thisMovie;if(user&&currentState.state.isMounted&&thisMovie!==\"\"){var docRef=db.collection(\"user\").doc(auth.currentUser.email);docRef.get().then(function(doc){var newWatchlist=doc.data().watchlist;var index=newWatchlist.indexOf(thisMovie);if(index>-1){currentState.setState({isAdd:true});}}).catch(function(error){console.log(\"Error getting document:\",error);});}});});}).catch(function(err){console.log(err);});fetch(\"https://www.omdbapi.com/?apikey=1e54e73e&i=\"+this.props.location.id).then(function(response){response.json().then(function(data){_this2.setState({movies:data});});}).catch(function(err){console.log(err);});case 3:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()/* checkExists(id) {\n    if (this.state.isAdd === \"false\") {\n      console.log(\"isadd\")\n      db.collection(\"user\")\n        .doc(auth.currentUser.email)\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          var index = newWatchlist.indexOf(id)\n          if (index > -1) {\n            this.setState({\n              isAdd: true\n            })\n          }\n\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n\n      this.setState({\n        isAdd: !this.state.isAdd\n      })\n    }\n  } */},{key:\"setWatchList\",value:function setWatchList(id){var userRef=db.collection(\"user\").doc(auth.currentUser.email);if(this.state.isAdd){userRef.get().then(function(doc){var newWatchlist=doc.data().watchlist;var index=newWatchlist.indexOf(id);if(index>-1){newWatchlist.splice(index,1);}userRef.update({watchlist:newWatchlist});}).catch(function(error){console.log(error);});this.setState({isAdd:!this.state.isAdd});}else{userRef.get().then(function(doc){var newWatchlist=doc.data().watchlist;newWatchlist.push(id);userRef.update({watchlist:newWatchlist});}).catch(function(error){console.log(error);});this.setState({isAdd:!this.state.isAdd});}}},{key:\"render\",value:function render(){var _this3=this;return React.createElement(Container,{key:\"\"},this.state.movie?React.createElement(\"div\",null,React.createElement(Row,null,React.createElement(\"a\",{title:\"if u stan imdb...\",className:\"movie-title\",rel:\"noopener noreferrer\",target:\"_blank\",href:\"https://www.imdb.com/title/\"+this.state.movie.id},this.state.movie.title,\" (\",this.state.movie.year,\")\")),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-poster\"},this.state.movie.poster?React.createElement(\"a\",{title:\"trailer is here!\",className:\"movie-title\",rel:\"noopener noreferrer\",target:\"_blank\",href:this.state.movie.trailer?this.state.movie.trailer.link:\"/\"},React.createElement(\"img\",{className:\"movie-actual-poster\",alt:this.state.movie.title,src:this.state.movie.poster})):\"\")),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-director\"},\"directed by: \",this.state.movies.Director)),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},this.state.movies.Rated,\" | \",this.state.movies.Runtime,\" | \",this.state.movies.Released)),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},this.state.movies.Country,\" | \",this.state.movies.Language)),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},\"IMDb rating: \",this.state.movies.imdbRating,\" | Metascore: \",this.state.movies.Metascore)),this.state.movies.Production?React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-director\"},\"this.state.movies.Production\")):\"\",React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},\"AWARDS: \",this.state.movies.Awards)),React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-info\"},\"PLOT: \",this.state.movies.Plot)),this.state.movie.cast?this.state.movie.cast.map(function(item){return React.createElement(Row,{key:\"yay\"},React.createElement(\"div\",{className:\"movie-actor\"},React.createElement(\"a\",{title:\"visit fav actor\",className:\"movie-actor-link\",rel:\"noopener noreferrer\",target:\"_blank\",href:'https://www.imdb.com/name/'+item.actor_id},item.actor),\" as \",item.character));}):\"\",React.createElement(Row,null,React.createElement(\"div\",{className:\"movie-btn\"},React.createElement(Button,{onClick:function onClick(){_this3.setWatchList(_this3.state.movie.id);},className:\"movie-rl-btn\"},this.state.isAdd?React.createElement(TiMinusOutline,null):React.createElement(TiPlusOutline,null),\"watchlist\")))):React.createElement(Media,null,\"wait a sec bru\"));}}]);return Movie;}(React.Component);export default Movie;","map":{"version":3,"sources":["/home/lishi/Desktop/fullstack/movie-fanatic-club/src/components/Movie.js"],"names":["React","Media","Container","Row","Button","TiPlusOutline","TiMinusOutline","auth","db","firebase","Movie","props","state","movie","movies","loading","isAdd","thisMovie","isMounted","addToWatchlist","bind","removeFromWatchlist","watchlistRef","collection","doc","currentUser","email","update","watchlist","firestore","FieldValue","arrayUnion","id","alert","setWatchList","checkExists","arrayRemove","setState","fetch","location","method","headers","then","response","json","data","onAuthStateChanged","user","currentState","docRef","get","newWatchlist","index","indexOf","catch","error","console","log","err","userRef","splice","push","title","year","poster","trailer","link","Director","Rated","Runtime","Released","Country","Language","imdbRating","Metascore","Production","Awards","Plot","cast","map","item","actor_id","actor","character","Component"],"mappings":"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","sourcesContent":["// body component for loading stuff about an individual movie\n// when the user clicks on it\n\nimport React from \"react\";\nimport \"../index.css\";\nimport { Media, Container, Row, Button } from \"reactstrap\";\nimport { TiPlusOutline, TiMinusOutline } from \"react-icons/ti\";\nimport { auth, db } from \"./Firebase\";\nimport firebase from \"firebase\";\n\nclass Movie extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      movie: {},\n      movies: {},\n      loading: true,\n      isAdd: false,\n      thisMovie: \"\",\n      isMounted: false\n    };\n\n    this.addToWatchlist = this.addToWatchlist.bind(this);\n    this.removeFromWatchlist = this.removeFromWatchlist.bind(this);\n  }\n\n  addToWatchlist() {\n    var watchlistRef = db.collection(\"user\").doc(auth.currentUser.email);\n    watchlistRef.update({\n      watchlist: firebase.firestore.FieldValue.arrayUnion(this.state.movie.id)\n    });\n    alert(\"adding to watchlist\");\n    this.setWatchList = this.setWatchList.bind(this)\n    this.checkExists = this.checkExists.bind(this)\n  }\n\n  removeFromWatchlist() {\n    var watchlistRef = db.collection(\"user\").doc(auth.currentUser.email);\n    watchlistRef.update({\n      watchlist: firebase.firestore.FieldValue.arrayRemove(this.state.movie.id)\n    });\n    alert(\"removing from watchlist\");\n  }\n\n  async componentDidMount() {\n    this.setState({ isMounted: true })\n\n    fetch(\n      \"https://imdb-internet-movie-database-unofficial.p.rapidapi.com/film/\" +\n      this.props.location.id,\n      {\n        method: \"GET\",\n        headers: {\n          \"x-rapidapi-host\":\n            \"imdb-internet-movie-database-unofficial.p.rapidapi.com\",\n          \"x-rapidapi-key\": \"c3bfcbae69msh2fefac5f7da67adp1d2687jsnade70055f49b\"\n        }\n      }\n    )\n      .then(response => {\n        response.json().then(data => {\n          this.setState({\n            movie: data,\n            thisMovie: data.id\n          })\n\n          auth.onAuthStateChanged(user => {\n            let currentState = this, thisMovie = currentState.state.thisMovie\n            if (user && currentState.state.isMounted && thisMovie!== \"\") {\n              var docRef = db.collection(\"user\").doc(auth.currentUser.email);\n                docRef\n                  .get()\n                  .then(function (doc) {\n                    var newWatchlist = doc.data().watchlist;\n                    var index = newWatchlist.indexOf(thisMovie)\n                    if (index > -1) {\n                      currentState.setState({\n                        isAdd: true\n                      })\n                    }\n          \n                  })\n                  .catch(function(error) {\n                    console.log(\"Error getting document:\", error);\n                  });\n            }\n          })\n        })\n      })\n      .catch(err => {\n        console.log(err);\n      });\n\n    fetch(\n      \"https://www.omdbapi.com/?apikey=1e54e73e&i=\" + this.props.location.id\n    )\n      .then(response => {\n        response.json().then(data => {\n          this.setState({\n            movies: data\n          })\n        })\n      })\n      .catch(err => {\n        console.log(err);\n      });\n\n  }\n\n\n  /* checkExists(id) {\n    if (this.state.isAdd === \"false\") {\n      console.log(\"isadd\")\n      db.collection(\"user\")\n        .doc(auth.currentUser.email)\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          var index = newWatchlist.indexOf(id)\n          if (index > -1) {\n            this.setState({\n              isAdd: true\n            })\n          }\n\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n\n      this.setState({\n        isAdd: !this.state.isAdd\n      })\n    }\n  } */\n\n  setWatchList(id) {\n    let userRef = db.collection(\"user\").doc(auth.currentUser.email)\n    if (this.state.isAdd) {\n      userRef\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          var index = newWatchlist.indexOf(id)\n          if (index > -1) {\n            newWatchlist.splice(index, 1)\n          }\n          userRef.update({\n            watchlist: newWatchlist\n          })\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n\n      this.setState({\n        isAdd: !this.state.isAdd\n      })\n    }\n    else {\n      userRef\n        .get()\n        .then(function (doc) {\n          var newWatchlist = doc.data().watchlist;\n          newWatchlist.push(id)\n          userRef.update({\n            watchlist: newWatchlist\n          })\n        })\n        .catch(function (error) {\n          console.log(error)\n        })\n\n      this.setState({\n        isAdd: !this.state.isAdd\n      })\n    }\n  }\n\n  render() {\n\n    return (\n      <Container key=\"\">\n        {this.state.movie ?\n          <div>\n            <Row>\n              <a title=\"if u stan imdb...\" className=\"movie-title\" rel=\"noopener noreferrer\" target=\"_blank\" href={\"https://www.imdb.com/title/\" + this.state.movie.id}>{this.state.movie.title} ({this.state.movie.year})</a>\n            </Row>\n            <Row>\n              <div className=\"movie-poster\">\n                {this.state.movie.poster ?\n                  <a title=\"trailer is here!\" className=\"movie-title\" rel=\"noopener noreferrer\" target=\"_blank\" href={this.state.movie.trailer ? this.state.movie.trailer.link : \"/\"}>\n                    <img className=\"movie-actual-poster\" alt={this.state.movie.title} src={this.state.movie.poster} />\n                  </a>\n                  : \"\"}\n\n              </div>\n            </Row>\n            <Row><div className=\"movie-director\">directed by: {this.state.movies.Director}</div></Row>\n            <Row><div className=\"movie-info\">{this.state.movies.Rated} | {this.state.movies.Runtime} | {this.state.movies.Released}</div></Row>\n            <Row><div className=\"movie-info\">{this.state.movies.Country} | {this.state.movies.Language}</div></Row>\n            <Row><div className=\"movie-info\">IMDb rating: {this.state.movies.imdbRating} | Metascore: {this.state.movies.Metascore}</div></Row>\n            {this.state.movies.Production ?\n              <Row><div className=\"movie-director\">this.state.movies.Production</div></Row> : \"\"}\n            <Row><div className=\"movie-info\">AWARDS: {this.state.movies.Awards}</div></Row>\n            <Row><div className=\"movie-info\">PLOT: {this.state.movies.Plot}</div></Row>\n            {this.state.movie.cast ?\n              this.state.movie.cast.map(item => {\n                return (\n                  <Row key=\"yay\"><div className=\"movie-actor\">\n                    <a title=\"visit fav actor\" className=\"movie-actor-link\" rel=\"noopener noreferrer\" target=\"_blank\" href={'https://www.imdb.com/name/' + item.actor_id}>{item.actor}</a> as {item.character}\n                  </div></Row>\n                )\n              })\n              : \"\"}\n            <Row>\n              <div className=\"movie-btn\">\n                <Button\n                  onClick={() => {\n                    this.setWatchList(this.state.movie.id)\n                  }}\n                  className=\"movie-rl-btn\">{this.state.isAdd ? <TiMinusOutline /> : <TiPlusOutline />}\n                watchlist\n              </Button>\n\n              </div>\n            </Row>\n          </div>\n          : <Media>wait a sec bru</Media>}\n      </Container>\n    );\n  }\n}\n\nexport default Movie;\n"]},"metadata":{},"sourceType":"module"}